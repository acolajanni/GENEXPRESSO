---
title: "expressoComparison"
author: "Antonin Colajanni"
date: "04/06/2021"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
library(UpSetR)
library(GENEXPRESSO)

```

# Comparaison des méthodes de la fonction expresso() du package affy

```{r load, include=TRUE}
load("./dataToComp.RData")
# Gènes en colonnes / lignes = méthodes
data.to.comp = as.data.frame(t(data.to.comp))
data.to.comp
```

# Divisions des méthodes point par point : 

# On ne change qu'un paramètre à la fois : 
paramètres par défaut : 
sumstat = mas
norm = "constant"
pm.cor = "mas"
bg.cor = "mas"

DEG : Ranksum

```{r BGcorrect, include=TRUE}
# Liste de toute les méthodes
methods = row.names(data.to.comp)
# Dataframe rempli de valeur binaire (0/1)
upset = Upset.Binary.Dataframe(data.to.comp)
```



## Background correct : 
```{r bg, include=TRUE}
# comparaison pm
methods_bg.cor = upset[grepl("background",methods)]
methods_bg.cor

upset(methods_bg.cor, 
      sets = c("background mas Up", "background rma Up"), 
      sets.bar.color = "#56B4E9", 
      order.by = "freq", 
      )
upset(methods_bg.cor, 
      sets = c("background mas Down", "background rma Down"), 
      sets.bar.color = "#56B4E9", 
      order.by = "freq", 
      )

```

## PM correction : 
la méthode "subtractmm" est éliminée (produit un jeu de données remplie de 'NAs') 
```{r pm, include=TRUE}
methods_pm.cor = upset[grepl("pm.cor",methods)]

upset(methods_pm.cor, 
      sets = colnames(methods_pm.cor)[grepl("Up",colnames(methods_pm.cor))], 
      sets.bar.color = "#56B4E9", 
      order.by = "freq", 
      )

upset(methods_pm.cor, 
      sets = colnames(methods_pm.cor)[grepl("Down",colnames(methods_pm.cor))], 
      sets.bar.color = "#56B4E9", 
      order.by = "freq", 
      )
```

## Express summary Stat :
 - medianpolish : fait un log2() des valeurs
 - playerout : boucle infinie ?
 


